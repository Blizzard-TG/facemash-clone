<!-- leaderboard.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Leaderboard - PictureMash</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <nav>
    <a href="index.html">Home</a>
    <a href="signup.html">Sign Up</a>
    <a href="login.html">Login</a>
    <a href="vote.html">Vote</a>
    <a href="leaderboard.html" class="active">Leaderboard</a>
    <a href="upload.html">Upload</a>
  </nav>

  <section class="leaderboard-section">
    <h2>Leaderboard</h2>
    <div id="leaderboardContainer" class="leaderboard-list"></div>
    <div id="adminPanel" style="display:none;">
      <h3>Admin Controls</h3>
      <button onclick="refreshScores()">Update Scores</button>
    </div>
  </section>

  <script>
    const token = localStorage.getItem('authToken');
    const userRole = localStorage.getItem('userRole'); // 'admin' or 'user'

    async function fetchLeaderboard() {
      try {
        const res = await fetch('https://your-backend-url.com/leaderboard');
        if (!res.ok) throw new Error('Failed to fetch');
        const data = await res.json();

        const container = document.getElementById('leaderboardContainer');
        container.innerHTML = '';

        if (Array.isArray(data) && data.length > 0) {
          data.forEach((item, index) => {
            const div = document.createElement('div');
            div.className = 'leaderboard-item';
            div.innerHTML = `<strong>#${index + 1}</strong> Votes: ${item.votes} | Score: ${item.score}`;
            container.appendChild(div);
          });
        } else {
          container.innerHTML = '<p>No leaderboard data available.</p>';
        }

        if (userRole === 'admin') {
          document.getElementById('adminPanel').style.display = 'block';
        }
      } catch (err) {
        console.error('Failed to fetch leaderboard', err);
        document.getElementById('leaderboardContainer').innerHTML = '<p>Error loading leaderboard.</p>';
      }
    }

    async function refreshScores() {
      try {
        const res = await fetch('https://your-backend-url.com/admin/update-scores', {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          }
        });
        const result = await res.json();
        alert(result.message || 'Scores updated');
        fetchLeaderboard();
      } catch (err) {
        console.error('Failed to update scores', err);
        alert('Failed to update scores.');
      }
    }

    fetchLeaderboard();
  </script>
</body>
</html>

